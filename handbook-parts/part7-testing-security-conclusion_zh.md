## 测试

想象一下，你的工作不是测试软件代码，而是担任市政桥梁的检查员。桥梁已经建好，现在你的工作是检查它并决定是否允许它向公众开放。你会检查桥梁上的每一个螺栓和铆钉吗？这样做可能会让你对桥梁的安全性有很高的信心，但也需要很长的时间，并且会打乱市长下周开放桥梁的计划。

另一个合理的策略是准确决定桥梁的哪些元素对于达到指定的安全系数至关重要，并测试/检查这些元素。也许只需要每隔一个铆钉，加上所有的钢缆和结构混凝土。

同样，在软件工程测试中，目标不是为了覆盖率而覆盖率，而是提供信心，确保软件能够按预期工作。

有效的软件测试并不总是追求 100% 的代码覆盖率。一个好的软件测试套件的标准是，它能够让你的团队确信，当构建是绿色的且所有测试都通过时，软件已经准备好发布给最终用户。这可能意味着 100% 的代码覆盖率，也可能意味着 30% 的代码覆盖率。确切的数字由你决定和监控，如果你发现测试没有提供与过去相同的信心（相反，如果你发现投入过度，即在测试套件上花费了大量资源，但错误仍然频繁出现），这个投入量可能会随着时间而改变。


### 测试/质量保证团队

根据团队规模，你可能没有专门的测试团队，或者有一个测试团队负责一种或多种类型的测试，或者有多个测试团队负责各种软件测试。无论谁在进行测试，重要的是要认识到软件测试是一个复杂的过程，细节很重要。要有效地测试软件，测试人员，无论是他们自己编写的代码还是别人扔给他们的代码，都必须深入理解代码/软件应该做什么。你的职责是建立团队，让他们能够相互理解。要做到这一点，确保团队共享目标/KPI，你的流程在开发人员和测试人员之间有强大而持续的沟通，并监控团队之间有健康、富有成效的关系。

### 测试质量

在深入研究不同软件测试范式的细节之前，值得思考一下软件测试的目的是什么，从而了解什么是好的测试，相反，什么是坏的测试。

定义坏测试很简单。坏测试对团队来说成本高于收益。坏测试的一些常见特征：

* 维护和修复测试以适应合理的代码更改所需的时间，超过了通过发现错误节省的痛苦。

* 测试具有高误报率或不一致，这会减慢 CI 速度，并导致开发人员沮丧和重新运行虚假失败的上下文切换成本。

* 测试考虑不周，实际上验证了代码做了错误的事情。

* 测试套件验证了代码做了正确的事情并且误报率低，但它太复杂且难以理解，以至于只有编写测试的人才能添加新的测试，而其他查看它的工程师都会头疼。

* 测试没有建立信心，表明正在评估的代码已准备好交付给最终用户。

考虑到这一点，相对容易看出好测试应该具有什么属性。好测试是：

* 在本地和共享 CI 环境中都易于快速运行

* 能够可靠运行并始终产生相同的结果，易于扩展

* 易于重构或更新以适应底层逻辑更改

* 适当地耦合到底层代码模式，在正确的高度（可以这么说）进行测试以捕获重要的破损

* 任何工程师都易于理解和使用

评估测试方法的最佳方式之一也是最明显的：通过简单的情绪分析来询问团队对测试的感受。结果往往是非常二元的——要么测试是团队依赖的安全来源，团队自然会扩展它们，因为它们显然是净增值；要么团队被动地，甚至主动地讨厌他们的测试，因为它们是生产力的消耗，没有足够明显的价值。

### 测试什么

你的团队应该以增强系统正常工作的信心为目标添加测试，同时尽量减少在面对有机系统增长时长期维护这些测试的额外负担。最小化这种痛苦的一般模式是测试公共接口。公共接口应该经过深思熟虑，并且随着时间的推移相对稳定。

它们也是软件消费者实际体验的正常路径。

因此，对公共接口的测试应该随着时间的推移变化很小，并且也能提供信心，表明重要的代码部分正在正常工作。

软件的公共接口可能因项目而异。对于许多项目，它将是一个实际的基于 HTTP 的 API；对于某些项目，它将是库或内部服务中的一组函数/类。对于其他项目，它可能是用户界面。

### 测试类型比较

软件测试可以分为以下类别/范式：

* 单元测试
* 集成测试
* 端到端测试
* 手动测试
* 半自动化测试

区分这些测试类型的属性如下：

**代码规划：** 为确保代码在此测试范式下可测试，在实际编写代码时需要多少预先考虑。

**测试范围：** 每个测试可以一次评估多少内容。

**变更粒度检测：** 测试可能检测到什么大小或类型的代码更改并导致失败。

**运行成本：** 运行测试的速度或成本，以时间或金钱衡量。

**添加工作量：** 添加额外覆盖所需的工作量。

**设置工作量：** 建立有效测试套件所需的工作量。

下表总结了五种范式如何映射到这些指标。请注意，没有一种完美的测试范式；每种都有权衡，我鼓励你仔细考虑哪些权衡对你的公司和代码库有意义。正确的答案通常是不同测试范式的混合，在应用程序中每种类型的测试在最能增加价值的地方使用。

TODO: 从书中插入表格


### 单元测试

单元测试通常是人们谈论软件测试时首先想到的。它在学校教授，并包含在教科书中，通常在现实世界中得到最多的努力。考虑到这一切，你可能会认为单元测试是最好的测试类型，尽管我认为情况并非总是如此。让我们首先明确定义单元测试，以便将其与其他测试范式区分开来。

单元测试完全在机器的内存中运行，与被评估的代码在共享内存空间中运行，不需要任何网络连接或依赖外部服务。大多数单元测试运行速度非常快，一次测试非常少量的代码，并且相对容易上手。单元测试通常也与你的代码契约紧密耦合，并且通常需要以模拟的形式编写新代码，以使被测试的代码能够在没有通常可用的外部依赖项的情况下执行。

单元测试的关键权衡及其主要缺点是它们与被测试的代码紧密耦合。单元测试很容易与实际函数调用和内部数据对象深度交织在一起。这种深度依赖意味着任何代码重构——即使是简单和良性的更改——也需要对单元测试进行相当大的更新。创建模拟和测试数据装置通常也需要大量代码来创建和维护，以允许单元测试运行，从而为单元测试框架增加了意外成本。

### 集成测试

集成测试放宽了单元测试的内存内和零依赖约束。因此，集成测试往往运行速度较慢，并在更高级别与被测试的代码集成。当它们在与被测试代码不同的进程中运行时，它们通常会行使外部公开的契约，例如 API。这意味着不改变 API 行为的内部重构往往不会被集成测试注意到，使得这些测试总体上不那么脆弱，但也不太可能检测到较小的副作用。

此外，集成测试需要创建更少或不需要模拟，因此可以减少要实现的代码。

### 端到端测试

端到端（e2e）测试以与最终用户相同的方式行使代码。对于后端代码，端到端测试和集成测试可能以相同的方式运行，通过外部契约运行代码。对于面向用户的前端代码，端到端测试通常涉及机械化客户端界面，通常是网络浏览器或移动手机。我不鼓励任何技术领导者编写自己的客户端机械化代码——这是一个特别棘手的问题，Selenium、Cypress 和 Puppeteer 等可下载工具可以为你解决。对于移动设备，有 HeadSpin 和 Detox 等工具。

在现实世界中，端到端测试的关键权衡是可靠性。至少在撰写本文时，可靠的网络端到端测试仍然有些难以捉摸；浏览器渲染的性质意味着竞争条件很容易意外发生。构建可靠的网络端到端测试套件需要相当的关注、对细节的关注和维护。

然而，回报并非微不足道，因为可以通过 e2e 测试套件创建非常高的测试覆盖率和对面向用户流程功能的非常高的信心。有几家公司，包括 testim.io 和 rainforestqa.com，正在探索使用 AI 和 ML 来解决这个问题。这些解决方案部署模糊视觉测试，而不是依赖于 CSS 选择器的存在或不存在，例如，试图提高测试可靠性。希望在你阅读本文时，技术水平已经进一步发展，端到端测试的价值主张将比撰写本文时更强。

#### 视觉回归测试

视觉回归测试是一个相对较新的范式，旨在通过对渲染的视觉进行增量检测来检测面向用户的应用程序中的缺陷。有些框架在不同的粒度级别上执行此操作，从捕获整个页面的屏幕截图到渲染单个组件，并产生增量以检测缺陷。明显的缺点是，对任何视觉测试组件的每个有意更改都需要更改测试。

幸运的是，这些测试框架通常使重现用于比较的正确视觉集变得简单而轻松，这开辟了另一个陷阱：通过简单的工具覆盖测试目标，很容易产生假阴性，不小心接受了实际上是错误的视觉增量。

#### 手动测试

顾名思义，手动测试由人类而非机器代码运行。对于测试代码的人类，我们可以进一步将这一类别细分为专业和非专业测试人员。

#### 专业手动测试

专业手动测试是内部手动测试团队。除了内部团队的传统优势外，例如一致的激励和长期的工作关系，内部团队的价值在于团队可以在你的产品中建立专业知识并深入了解你的用户。这使团队能够识别未经培训或不熟悉的测试人员可能会遗漏的缺陷。高质量的测试团队不仅可以作为捕获软件缺陷的资源，还可以在产品级别上提供有价值的反馈，识别设计中的不一致性，并就某些事物如何或为何以某种方式工作提出发人深省的问题。

出色的内部手动测试团队可以大大提高整体软件和产品质量。

专业手动测试团队应该为产品功能创建详细的测试计划，并以易于检索/重复的方式存储这些计划，理想情况下使用 TestRail 等工具，该工具允许创建完整的手动测试计划测试套件，团队可以按需手动重新运行。这种工具的另一个好处是与其他开发人员和产品工具集成——例如，将 TestRail 运行链接到 Jira epic，以显示为发布给定功能运行了多少手动和回归测试。这不仅作为启动检查清单项目很有价值，而且还有助于对任何已发布缺陷进行回顾，允许你重新访问在发布任何给定功能之前运行了哪些手动测试，并添加额外的手动测试以捕获通过的任何缺陷。

#### 非专业手动测试

非专业手动测试通常被称为众包测试。有几个专有平台可用于采购测试人员，例如 Rainforest QA、Pay4Bugs、99Tests 和 Testlio。这些平台的定价模式通常根据提交的已验证错误数量而变化。根据你的产品性质和你要优化的缺陷类型，众包测试可以成为提高产品质量的一种非常经济有效且低工作量的方式。

### 半自动化测试

半自动化测试是软件测试的一个相对较新的类别。这些测试由非技术人员创建——也许是你的专业手动测试团队——然后在完全自动化或监督环境中运行。

这些测试的主要缺陷是可靠性。因为它们是由非技术人员创建的，所以它们可能不像完全自动化的测试那样精确，使它们更容易出现误报和假阴性。也就是说，这个领域正在快速发展，每年都有新的公司和工具推出，例如 Rainforest QA 和 Testim，采用策略来提高可靠性和降低总成本。
## 源代码管理

绝大多数公司用于管理源代码控制的行业标准是 Git。你的组织使用其他任何东西都需要非常充分的理由；你当前和未来的大多数团队成员在到来时已经掌握了 Git 的基础知识。不使用它，你可能会给他们带来不必要的学习曲线，迫使他们学习你选择的替代方案。

有三个主要的云 Git 托管平台：GitLab、GitHub 和 Bitbucket。这三个占据了市场的绝大部分份额，同样，在偏离这些标准之前，你应该仔细考虑。

Git 有一个有趣形状的学习曲线。大多数人达到了一个平台期，他们以基本的理解操作，这使他们在大多数正常路径测试场景中能够应付。然而，有时事情会出错，开发人员丢失了提交或在合并中制造了混乱。当这种情况发生时，他们未能攀登 Git 学习曲线的其余部分将导致沮丧和减速。我鼓励你作为团队负责人，努力攀登曲线的后半部分。专门在命令行上使用 Git，以熟悉实际发生的事情。了解 reflog、交互式变基、二分查找和各种内置合并策略。掌握了这些知识，你可以绕过整个类别的生产力消耗问题，并培训你的团队成为 Git 专家。


### 同行评审

一般来说，专家建议为所有代码更改实施强大的同行评审流程。（在我撰写本文时，即 2023 年初，有一个日益增长的运动挑战这一建议，或者至少为其添加细微差别，我将在下一节中讨论。）大多数同行评审是通过所谓的——取决于你的代码托管解决方案——拉取请求、代码审查或合并请求来完成的。以下是保持代码审查高效和高效的一些建议：

* 保持审查小！为代码审查设置最大大小，例如十个文件和 200 行。其他任何内容都应该分解为多个堆叠/增量审查。（堆叠审查是基于或依赖于先前审查的代码审查。完成后，审查按顺序合并以累加完整的更改。）

* 提前与团队确定代码审查的目标，并将其融入你的文化中。代码审查不是为了样式或琐碎的语义；这就是自动代码格式化程序/linter 和静态分析的作用。代码审查的目的是确保清晰性，识别架构问题，标记缺陷和偏离模式，注意边缘情况，并保证遵守业务规则。

* 要求作者让审查者的工作变得容易。作者应该包括对更改的描述，相关需求和工单的链接，以及代码的视频演练（使用 loom.com 等工具）以及代码按预期工作的演示。

* 鼓励任何给定代码审查的作者在要求其他人审查之前进行自我审查。作者的一些精心放置的注释可以节省大量时间来引导读者。

* 留出专门的审查时间/窗口以尽量减少干扰。


### Ship, Show, Ask

普遍的智慧是，在将每个代码更改发送给客户之前，应该由两个人审查。与一切一样，这里有权衡。手动代码审查不是免费的，也不能保证软件质量。鉴于手动代码审查是有成本的，值得考虑何时该成本提供最高回报，并将代码审查作为最高 ROI 场景的工具。这个一般想法是由 Rouan Wilsenach 在 2021 年的一篇题为 Ship/Show/Ask (ctohb.com/ssa) 的博客文章中普及的。

让我们检查代码审查的成本。代码审查需要两个人——称他们为作者和审查者——经历多次上下文切换。典型的异步代码模式可能如下：

**上下文切换 #1：** 作者停止在项目 1 上编码，设置代码审查，并标记审查者。作者开始在项目 2 上工作。

**上下文切换 #2：** 审查者收到通知，停止在项目 3 上的工作，开始审查项目 1。审查者为作者留下反馈，恢复在项目 3 上的工作。

**上下文切换 #3：** 作者收到关于项目 1 的反馈通知，停止在项目 2 上的工作，处理审查者的评论。然后作者恢复在项目 2 上的工作。

**上下文切换 #4：** 审查者停止在项目 3 上的工作，最佳情况下，审查者现在对项目 1 的更改感到满意并批准代码审查。审查者恢复在项目 3 上的工作。最坏的情况下，作者和审查者必须多次重复上下文切换 #3 和 #4。

**上下文切换 #5：** 作者收到批准通知，停止在项目 2 上的工作，合并项目 1，然后恢复在项目 2 上的工作。

有一些方法可以最小化这些上下文切换，但它们也涉及权衡。一个常见的替代方案是将所有代码审查作为同步配对编程练习进行；然而，该策略将上下文切换换成同步会议时间，这仍然是生产力的拖累。无论你如何切分，人工代码审查都是昂贵的。

我建议的替代方案是按风险级别对工作类型进行分类，以及代码审查的预期收益。示例分类系统：

 琐碎的更改——不需要批准

- 复制/翻译更新
- 次要 UI 更改，理想情况下提交更改的视觉证据
- 仅测试更改
- 明确尚未使用或在功能开关后禁用的新代码
- 客户或用户无法访问的代码（例如，隐藏页面）

 次要更改——最少审查或事后审查

- 带有测试并涉及现有模式和功能增强的代码更改
- 具有有限或没有实际使用的代码（例如，未部署的产品）
- 可以通过可靠测试证明正确的重构

 主要更改——仔细的前期审查

- 涉及新工具、框架、模式或架构的任何内容
- 重大的新功能
- 涉及敏感数据或 PII 或可能影响安全态势的任何内容

尽管我相信这个系统提高了整体团队效率，但我承认它并不适合所有人。许多合规制度（例如 PCI 或 SOC 2）要求 100% 人工代码审查的政策。在这种情况下，你能做的最好的就是遵守，也许划分出不受合规框架管辖的产品或功能区域，以试验更细致和高效的流程。

### 分支模型

有许多方法可以处理源代码控制分支，尽管整个行业正在围绕基于主干的开发概念建立势头。由于这似乎是目前最有效和最常用的模式，这就是我们将在这里讨论的内容。如果你正在认真考虑不同的模式，你会在网上找到大量讨论方法论和替代方法最佳实践的资源。

有许多博客文章提供了有用的图形来介绍 git 分支模型，例如 Reviewpad 的这篇文章：ctohb.com/branching。如果以下描述对你没有意义，我敦促你参考这些文章及其相关的视觉效果。

在传统的分支模型中——有时称为 GitFlow——有两个长期存在的分支，一个 main 和一个 develop 分支。工作基于 develop 在功能分支中完成，然后通常为任何给定的发布分叉到另一个发布分支，最后合并回 main。然后在 main 上进行热修复，而进一步的开发在 develop 上进行。这个系统涉及到每个更改至少四个分支才能到达生产环境，并涉及同时维护许多分支。由于这些原因和其他原因，GitFlow 在很大程度上已经失宠，不再被认为是最佳实践。

基于主干的开发，以及它稍微复杂的表亲 GitHub Flow，是管理源代码的模型，旨在最小化分支的数量和持续时间。GitHub Flow 和基于主干的开发的确切实现会有所不同，但它们的共同点是有一个分支，其名称不同且不太重要。在这里我们称之为 production。Production 始终可部署。事实上，我建议你设置自动化，以便每次提交到 production 都可以实际部署到生产环境。然后可以在 production 的功能分支中进行工作，在功能分支中进行审查，并在准备好时合并。就是这样——一个长期存在的分支和许多短期存在的（理想情况下是小的）功能分支。

为了使这个模型运行良好，你需要一些先决条件：

* 持续集成，运行强大的测试套件，以确保功能分支可以安全合并。

* 使用功能开关的文化和实现，以便可以快速合并分支，然后在对业务有意义时在稍后的日期部署/启用功能。

* 对生产环境的强大监控以检测更改。

* 能够快速部署代码更改到生产环境的能力，零停机时间。同样，能够快速恢复单个更改以响应事件的能力。

* 一种纪律严明的文化，关于小而短期的功能分支。如果功能分支变得庞大、长期存在且难以管理，GitHub Flow 模型就会失去其效率和简单性。如第 3.3.5 节功能分支环境中所讨论的，小提交、小分支和小拉取请求是生产力的关键驱动因素。

### 长期存在的分支与短期存在的分支

保持团队平稳的分支和合并系统的关键是保持分支短期存在。几乎所有与代码合并相关的问题都来自代码分支开放时间过长或分支包含差异过大（ctohb.com/diffs）。一般来说，短期分支应该只开放几天，或者最多两周。

请记住，功能不一定必须在单个分支中实现。例如，你可以有一个初始分支，只包含测试，经过审查和合并，然后跟进一个包含实现的分支。或者，你可以构建一个未连接到主应用程序的实现，将其审查和合并，然后在后续分支中构建连接和测试。

通过一些思考和实践，大多数实现可以分解为独立可合并的片段。这是一项技能，在你的指导下，团队可以随着时间的推移发展。

保持分支短期存在的好处：

* 限制了将其他分支的新代码合并到主干的时间，从而限制了代码冲突的范围。较小的分支本质上也具有较少的冲突表面积。

* 保持功能分支代码相对较小，从而使审查者更容易阅读并限制破损的范围。

* 鼓励在审查中更快的反馈，并允许在实现功能的过程中更早地进行方向修正。

* 鼓励你的团队拥有可靠的持续集成系统。频繁的合并将突出显示构建/测试环境的缺陷，如果系统不可靠，会使其痛苦，并激励改进这些系统。

## 生产事件升级

升级器是一个工具，它接收事件并管理待命轮换，呼叫待命工程师，如果页面未被确认，则升级给其他人。PagerDuty 可能是这些工具中最受欢迎的。

### 实施升级器

在实施升级器并设置轮换之前，请确保团队中的工程师已经选择加入轮换，并且每个人都知道并理解创建例外的期望（例如，在假期期间与其他人交换待命窗口）。

你还需要确保有足够的文档，并且每个人都了解接收页面时要做什么的标准程序。建立这些程序的一些考虑因素：

* 注意收件人应在何处发布页面收据的确认（可能在升级器工具本身或专门用于处理升级的共享群聊中）。
* 轻松访问用于帮助诊断特定类型问题的手册。
* 确定是否以及在何处设置任何类型的站点停机通知（例如，需要更新公司状态页面）。
* 决定在哪里以及多久发布一次关于调查状态、影响估计和恢复估计的更新。
* 确定事件关闭后要做什么，安排根本原因分析练习并确保特定事件不再发生。

### 根本原因分析（RCA）练习

每当出现对用户有可衡量影响的系统问题时，你的团队都应该进行某种程度的根本原因分析（RCA）。RCA 的目标是了解你的系统在哪里出现故障，允许有影响的缺陷进入生产环境和最终用户。

必须明确的是，根本原因分析*不能*是关于识别过错或分配责任。这需要在 RCA 流程的每个部分都是真实的，并嵌入到团队的文化中。RCA 攻击系统中允许故障发生的系统性问题（而不是人为错误）。

没有这种安全性和团队成员愿意坦率地提供反馈和文档，你将错过改进系统的关键机会。

#### RCA 文档

你的团队应该为每个 RCA 以某种形式生成文档。根据你的系统出现问题的频率和这些问题的性质，你可能希望为 RCA 创建分类系统，低影响事件获得轻量级 RCA 流程，而高影响事件获得重量级流程。应该承认，对高影响事件进行彻底的 RCA 是一项昂贵的工作，需要大量时间和深思熟虑，对于琐碎的缺陷来说可能证明过于繁重。

也就是说，对于大多数公司来说，最好在这个领域过度投资，确保更高的可靠性。你应该从对所有事情进行彻底的 RCA 开始，一旦你对团队将面临的问题类型和影响有了很好的了解，就转向分层的 RCA 系统。

对于需要完整、深思熟虑分析的问题，这里有一个模板可以帮助你开始并向团队提出正确的问题：ctohb.com/rca。为每个事件创建一个像这样的新文档并将它们组织在内部公司文档存储中以供以后参考是一个好习惯，实际上也是大多数合规框架的要求。

#### RCA 会议和时间表

在解决事件后尽快切实可行时，指定一个适当的人员担任 RCA 的负责人。负责人应该克隆模板并开始填写有关事件的相关数据，并开始探索事件的五个为什么（ctohb.com/5whys）。

他们应该完成 RCA 的初稿，并在安排小组时间探索和尝试改进分析和未来预防步骤之前将其分发给相关同行。

会议参与者应提前阅读 RCA 草稿，并准备好探索事件的细节并就未来的预防步骤进行构思。

#### 选择 RCA 主要作者

RCA 负责人不一定是响应事件的人。理想的 RCA 负责人应该是非常熟悉所涉及系统的人，可以就工具和流程失败的地方提出深刻的问题，并为改进产生想法。

请注意，我们不是将犯了人为错误的任何人扔到巴士下面。如果他们符合先前的标准，那个人可能是 RCA 负责人，但他们的错误本身并不能使他们成为领导 RCA 的合适人选。他们当然应该做出贡献，并抓住机会通过这个过程学习。但同样，他们不会因为他们的错误而作为流程的一部分受到惩罚。撰写 RCA 不是一种惩罚；这是系统维护的重要责任和要素。

#### 安排 RCA 补救工作

一个好的 RCA 流程通常会为团队识别许多工作项目，以改进系统并使未来的事件不太可能发生。接下来的自然问题是：我们现在做吗？对于参与的工程师来说，答案可能是肯定的；对于关心达到截止日期和路线图的经理来说，答案将不太清楚。

这个问题没有一个正确的答案，但这里有一些一般性指导：

永远不要浪费一个好的危机。修复问题的动力将在事件和 RCA 会议周围达到顶峰，高度积极的工程师通常是最有效率的。也很容易低估系统可靠性问题对团队的总体成本，从而低估可靠性改进的优先级。生产事件的发生应该提醒你和你的团队，这些投资对于限制干扰和使团队能够专注于高效的功能工作并提供一致的高速度至关重要。

许多补救问题的工作量可能会有很大差异。一些典型的工单可能是添加更多日志记录或在我们的 CI 提供商中更改设置，以确保无法合并构建失败的 PR。这些类型的琐碎工单在待办事项中维护和整理的成本比当下做的成本更高，所以就这么做。它们是错误的事情的可能性很低，如果产生负面后果，它们可以很容易地逆转。

对于高工作量的补救步骤，我鼓励你对这些进行分类，并将它们通过常规计划流程。通常，高工作量的补救步骤可以在时间和计划的帮助下简化。换句话说，第一天确定的解决问题的正确方法可能不是理想的解决方案，只有通过将问题通过技术审查的常规步骤，才能出现更好的、可能成本更低的解决方案。

## IT

在这里，我将 IT，信息技术，称为用于日常开展业务的内部公司工具和技术。这与你的公司为其客户产品构建的技术形成对比。

IT 通常包括公司硬件（台式机、笔记本电脑和手机）、VPN、电子邮件、防病毒和监控软件等工具。作为现代世界的创业公司，无论你是现场团队还是远程团队，如果你做出一些明智的决定，你应该不需要在 IT 上花费很多时间或资本。

一些关键决策将帮助你在大多数小型科技公司最小化 IT 成本：

使用基于云的系统进行公司电子邮件、数据和文档。大多数创业公司使用 Google Workspace，但如果你的团队成员（和未来的潜在雇员）更熟悉替代方案，就使用它。在这个阶段设置你自己的内部邮件服务器、文档存储、数据访问、网络等没有任何好处。

早期，除非合规系统要求，否则不要求员工使用公司硬件。在小规模采购时（特别是在产品市场契合之前），配置和管理公司硬件是一项不小的工作（和成本！），仅提供边际或罕见的实际好处。

也许痛苦地承认，但正确保护你的产品和 IT 系统是一项相当大的任务，对于早期的年轻创业公司来说不切实际。我鼓励你务实，专注于从最可能的违规或数据盗窃来源保护你的系统：员工的人为错误。你的工程团队忘记在 API 前面放置身份验证，或者有人在咖啡店忘记锁定笔记本电脑，比攻击者设法中间人攻击你的数据或使用漏洞黑进你的云基础设施的可能性要大得多。

即使遵循最佳实践来最小化 IT 工作量，你仍然会有一些无法避免的 IT 任务，主要是激活和停用用户帐户以及员工的密码恢复。我鼓励你为其他同事（可能在 HR 中）记录和培训如何执行这些任务，以便它们不会定期打断你或工程团队。
## 安全与合规

在本节中，我将简要概述创业公司的安全和合规主题。你可以并且应该努力在这些主题上找到比本书更深入的资源。

### 身份验证安全术语

特别是在安全方面，使用精确和准确的语言很重要。一些常被误用的术语的定义：

**身份验证，或 AuthN**：验证用户或客户端是否是他们所说的人。你的登录系统执行用户身份验证。

**授权，或 AuthZ**：验证用户或客户端是否有权限执行他们试图执行的操作。你的基于角色的访问控制（RBAC）或权限系统进行授权。

**2FA 或 MFA**：双因素身份验证和多因素身份验证是使用多种类型的凭据向服务进行身份验证的过程。这通常使用密码（第一个因素）和某种所有权证明来完成，例如，通过电子邮件发送的一次性密码（证明你拥有电子邮件）、SMS（证明你拥有电话号码）或定时一次性密码（TOPT）（证明你拥有设备/密钥）。请注意，由于 SIM 卡移植攻击的普遍存在，攻击者能够拦截或重新路由 SMS，因此通常不鼓励使用 SMS 作为第二因素。


### 创业公司的安全

创业公司通常被定义为资源受限的程度。因此，安全态势和合规性通常是待办事项列表上首先被降低优先级的事情，因为它们不太可能对业务构成生存威胁，而不是其他紧迫的问题。如果你没有用户或收入，黑客有什么可窃取的？

考虑安全性也可能成为生产力的拖累或昂贵的任务，特别是如果你的任务是保护已经存在的系统。但如果你从第一天开始，你有机会在开始时做出良好的决定，以最小的额外成本创建强大的安全态势。

在你的创业公司中融入安全性的一些方法不会花费你太多：

* 在入职和培训材料中将安全性确立为团队思维中的优先事项。

* 让所有工程师参加入职和定期的基本安全培训——诸如 OWASP 十大或各种游戏化安全培训之类的事情，每月花几分钟时间保持安全意识。

* 依赖经过验证且维护良好的工具来处理与身份验证或授权相关的任何事情。

* 不要浪费时间自己构建登录页面；在 2023 年真的没有理由这样做。Auth0、SuperTokens 和 AWS Cognito 等工具提供安全的用户注册、登录、社交登录、忘记密码管理、电子邮件身份验证、双因素身份验证和会话管理。其中一些工具还提供强大的授权系统。处理身份验证是一个重要的项目；它非常复杂，错误代价高昂。你的创业公司没有理由需要解决那个问题。

* 不要在 IT 安全方面偷懒。无论你使用 Dropbox、Box、Google Drive、SharePoint 等，花几分钟时间设置策略以帮助避免人为错误，例如将默认共享权限设置为仅内部。设置定期数据共享报告，并指定员工每季度对任何特别敏感的文档或电子表格的权限设置进行审计。

* 使用企业密码管理解决方案，例如 1Password，并确保所有员工为重要工具使用强大的密码。同样，尽可能使用单点登录（SSO），并确保你的 SSO 提供商配置了高安全性（至少需要多因素身份验证）。

* 不要在代码库中提交秘密。利用安全的秘密管理器，例如 Google Cloud Secret Manager 或 AWS Secret Manager，在代码中提交秘密的名称/位置，并在生产环境中将该名称解析为值，可以在启动时使用 Berglas 或 Whisper 等工具，也可以在运行时直接使用秘密管理器 API。

### 合规

无论是由于你所在的行业、业务规模还是客户性质，大多数创业公司都需要遵守至少一个正式的合规框架。如果你的用户在欧洲，那么你需要遵守 GDPR。如果你正在获取用户数据，明智的做法是了解 CCPA。如果你与企业客户合作，你会被要求提供 SOC 2 或 ISO 27001 认证。在医疗保健领域，你有 HIPAA，如果你从事支付业务，你可能听说过 PCI DSS。

对于创业公司来说，保持符合这些框架中的任何一个或全部都可能是不可接受的昂贵。以下是保持合规和预期成本的一些提示：

* 不要试图在最后一刻获得合规证书。从头到尾准备和进行审计（例如 PCI DSS 或 SOC 2）是一个漫长的过程，对于大多数创业公司来说，从六个月到十二个月不等。早期开始并保持合规比晚开始并重做更便宜。

* 使用尽可能多的自动化来强制执行或提供合规证据。有一个蓬勃发展的 SaaS 公司部门专门从事自动化这些合规框架；Vanta、Tugboat Logic、Secureframe、Laika 和 Drata 等公司都有产品，将显著减少你的认证时间和总成本。

* 如果你足够幸运拥有正式的合规人员或部门，请依赖该关系。你越主动地与合规部门分享计划，越早纳入他们的反馈，保持合规的成本和挫败感就越低。
# 结论：衡量成功

你已经建立了一个出色的招聘流程，团队很满意，你像专业人士一样运行冲刺，你的架构经受住了业务不断增长的需求。这感觉很好，但你怎么知道这是否足够？我们如何衡量作为技术领导者或 CTO 的成功和绩效？

从 CFO 的角度来看，定义这个角色的卓越性的一种方法可能是：CTO 如何有效地部署研发预算并将其转化为工程和产品产出？

或者也许可以从 CEO 的角度来看：CTO 领导的团队能够多快地实现某些业务目标？

或者，鉴于人员领导对于在这个角色中表现出色有多重要，我们可以通过人文主义的视角来看待它：你的团队是否在做他们最好的工作？毕竟，伟大的 CTO 的使命是建立一个组织文化，让个人工程师能够做他们最好的工作，并用技术实现不可能的事情。

或者，与其试图定义一个单一的目标，也许 CTO 卓越性的最佳定义是 CTO 每天可能行使的所有技能的总和。也许伟大就是当你把架构、绩效管理、供应商管理、执行领导力、文化贡献、公共布道、指导和 DevOps 加在一起，通过一个公式，你得到一个大于 42 的数字。

尽管我们可能会尝试，但似乎伟大的领导力——即使是伟大的*技术*领导力——也不是我们可以精确量化或衡量的东西。聪明的头脑会努力就卓越性的共同描述达成一致，但我们都会同意这个角色是多样化和不断变化的，需要不断学习和适应。

工程领导力中很少有普遍真理，但其中之一是成为一名优秀的工程领导者是一个永无止境的自我完善、发现和成长之旅。沿着这条道路前进需要谦逊、愿意犯错，最重要的是好奇心和学习的愿望。

我希望这本手册对你在领导之旅中面临的挑战是一个有用的参考指南。手册涵盖了我自己多年来面临的许多挑战，以及我有幸与之互动的许多优秀领导者的挑战。

我已尽我最大努力为应对这些挑战提供一些结构，尽管每种情况都是独特的，最终你采取的路径是你自己设计的，结果是你自己拥有的。

在人生的某个时刻，有人会问：你会给年轻的自己什么建议？这本手册是我对这个问题的答案。

我希望它能帮助你在构建强大的技术、积极和授权的团队以及成功的企业的旅程中，最重要的是，享受乐趣并为世界做一些好事。
# 书籍参考文献

*Getting Things Done* by David Allen

*Extreme Programming Explained* by Kent Beck

*Work Rules!* by Laszlo Bock

*How to Win Friends and Influence People* by Dale Carnegie

*Agile Estimating and Planning* by Mike Cohn

*Good to Great* by Jim Collins

*The 7 Habits of Highly Effective People* by Stephen Covey

*Domain-Driven Design* by Eric Evans

*Patterns of Enterprise Application Architecture* by Martin Fowler *High Output Management* by Andy Grove

*Scaling Up* by Verne Harnish

*The Hard Thing About Hard Things* by Ben Horowitz

*Immunity to Change* by Robert Kegan

*The Phoenix Project* by Gene Kim

*The Five Dysfunctions of a Team* by Patrick Lencioni

*Managing Humans* by Michael Lopp

*Team of Teams* by Stanley McChrystal

*Escaping the Build Trap* by Melissa Perri

*Good Authority* by Jonathan Raymond

*Good Strategy/Bad Strategy* by Richard Rumelt

*Radical Candor* by Kim Scott

*The Art of Agile Development* by James Shore and Shane Warden

*Scrum: The Art of Doing Twice the Work in Half the Time* by Jeff Sutherland

*Extreme Ownership* by Jocko Willink and Leif Babin

## 数字参考文献

**VSCode's Setting Files** (ctohb.com/vscode): https://code.visualstudio.com/docs/getstarted/settings

**Key to Gmail** (ctohb.com/keytogmail): https://techcrunch.com/2010/03/14/key-to-gmail

**Shit Umbrella** (ctohb.com/umbrella): https://medium.com/@rajsarkar/word-of-the-month-shit-umbrella-33e3182a0f1b

**Liar's Paradox** (ctohb.com/liarsparadox): https://en.wikipedia.org/wiki/Liar\_paradox

**Gitlab Compensation Calculator** (ctohb.com/gitlabcompcalc): https://about.gitlab.com/handbook/total-rewards/compensation/

**Five Whys** (ctohb.com/5whys): https://en.wikipedia.org/wiki/Five\_whys

**Take the DORA DevOps Quick Check** (ctohb.com/dora): https://www.devops-research.com/quickcheck.html#questions

**Netflix Keeper Test** (ctohb.com/keeper): https://empowerment.ee/wp-content/uploads/2021/05/NETFLIX-%E2%80%93-THE-KEEPER-TEST.pdf

**Why GitLab Pays Local Rates** (ctohb.com/local): https://about.gitlab.com/blog/2019/02/28/why-we-pay-local-rates/

**What is the topgrading interview process?** (ctohb.com/interview): https://www.greenhouse.io/blog/what-is-the-topgrading-interview-process

**Topgrading** (ctohb.com/topgrading): https://en.wikipedia.org/wiki/Topgrading

**Painting the Bridge** (ctohb.com/painting): https://www.goldengate.org/bridge/bridge-maintenance/painting-the-bridge/

**Dare to Lead: e BRAVING Inventory** (ctohb.com/braving): https://brenebrown.com/resources/the-braving-inventory/

**Root Cause Analysis Template** (ctohb.com/rca): https://docs.google.com/document/d/1GuRZgDpMVg\_Qf3sR7r8tZqRx6Re0oBrwIcnj-ekgJ60/edit#

**Ship Small Diffs** (ctohb.com/diffs): https://blog.skyliner.io/ship-small-diffs-741308bec0d1

**GitHub Flow, Trunk-Based Development, and Code Reviews**(ctohb.com/branching): https://reviewpad.com/blog/github-flow-trunk-based-development-and-code-reviews

**Ship/Show/Ask** (ctohb.com/ssa): https://martinfowler.com/articles/ship-show-ask.html

**Thoughtworks Technology Radar 27** (ctohb.com/techradar): https://www.thoughtworks.com/en-us/radar

**Feature Toggles (aka Feature Flags)** (ctohb.com/hodgson): https://martinfowler.com/articles/feature-toggles.html

**Multi-stage Builds** (ctohb.com/docker): https://docs.docker.com/build/building/multi-stage/

**Choose Boring Technology** (ctohb.com/boring): https://boringtechnology.club/

**Technology Radar** (ctohb.com/radar): https://www.thoughtworks.com/en-us/radar

**The Waterfall Model** (ctohb.com/waterfall): https://en.wikipedia.org/wiki/Waterfall\_model#History

**The Pragmatic Programmer** (ctohb.com/tpp): https://en.wikipedia.org/wiki/e\_Pragmatic\_Programmer

**Rubber Duck Debugging** (ctohb.com/rdd): https://en.wikipedia.org/wiki/Rubber\_duck\_debugging

**FrequencyReducesDifficulty** (ctohb.com/fowler): https://martinfowler.com/bliki/FrequencyReducesDifficulty.html

**Figma Material Design** (ctohb.com/figma): https://www.figma.com/@materialdesign

**How to Design with the Atlassian Design System** (ctohb.com/design): https://atlassian.design/get-started/design

**Building Productive Teams** (ctohb.com/teams): https://docs.microsoft.com/en-us/DevOps/plan/building-productive-teams

**GitHub Compensation Calculator** (ctohb.com/calc): https://about.gitlab.com/handbook/total-rewards/compensation/

**Codeacademy Engineering Competencies** (ctohb.com/competencies): https://github.com/Codecademy/engineering-competencies

**e Multitasking Myth** (ctohb.com/myth): https://blog.codinghorror.com/the-multi-tasking-myth

**Acronyms Seriously Suck: Elon Musk** (ctohb.com/acronyms): https://gist.github.com/klaaspieter/12cd68f54bb71a3940eae5cdd4ea1764

**How We Work Without Meetings at Levels** (ctohb.com/async): https://medium.com/levelshealth/how-we-work-without-meetings-at-levels-a6a525e21aa5

**Collaborate with kindness: Consider these etiquette tips in Slack** (ctohb.com/slack): https://slack.com/blog/collaboration/etiquette-tips-in-slack

**How to Use Skip-Level Meetings Effectively** (ctohb.com/skip): https://www.managementcenter.org/resources/skip-level-meeting-toolkit/

**From Founder to CTO** (ctohb.com/founder2cto): https://calv.info/founder-cto

**How to Prioritize the Developer Experience and Improve Output** (ctohb.com/dx): https://www.harness.io/blog/developer-experience
# 术语表

**敏捷仪式**：敏捷仪式是开发团队在开发过程的各个阶段聚在一起进行讨论的会议，用于规划未来的工作、沟通正在进行的工作或审查和反思过去的工作。

**申请人跟踪系统（ATS）**：申请人跟踪系统（ATS）是招聘人员和雇主在整个招聘和雇用过程中跟踪候选人的软件。

**童子军规则**：让事情比你发现时更好。应用于技术团队，每当你在某个代码区域工作时，总是做出哪怕是很小的改进，也许是测试，或文档，或以其他方式提高清晰度、可读性或可维护性。

**棕地开发**：绿地开发的反面：处理现有的遗留系统，通常受到技术债务的严重影响。你被过去做出的高层决策所困，并且对于大规模变革的灵活性有限。

**商业智能（BI）**：商业智能（BI）是摄取业务数据并以用户友好的视图（如报告、仪表板、图表和图形）呈现它的软件。

**ClickOps**：ClickOps 是一个容易出错且耗时的过程，人们通过云提供商网站中的各种菜单选项进行点击，以选择和配置正确的自动化计算基础设施。

**容器化**：容器化涉及将包含运行应用程序所需的所有必要元素的软件打包到容器环境中。这允许组织从任何地方运行应用程序——在私有数据中心、公共云甚至个人笔记本电脑中。

**上下文切换**：从一个任务切换到另一个任务。对于工程师来说，这意味着搁置正在处理的问题并开始处理另一个问题。切换的行为通常耗时且效率低于一次处理一个问题。

**直接下属**：直接下属是直接向组织结构图中高于他们的人报告的员工，通常是经理、主管或团队负责人。

**工程产品与设计（EPD）**：将传统上三个独立部门的内容组合到一个部门的想法：设计、产品和工程。首字母缩写词的顺序经常更改，EDP、PDE。

**绿地解决方案**：绿地软件开发是指在新环境中进行的开发工作，具有最少的预先存在的遗留代码，并且可以自由选择工具、模式和架构。

**地平线一/二/三**：每个地平线代表不同的时间尺度。地平线一通常是短期（天/周），二是中期（月），三是长期（年）。通常用作计划工具，以确保你适应每个地平线。

**幂等**：如果操作的后续执行不改变输出，则技术操作是幂等的。

**改善**：改善是在组织中持续改进所有流程的哲学。

**关键绩效指标（KPI）**：KPI 是朝着预期结果进展的关键可量化指标。有时被称为输入指标。

**目标和关键结果（OKR）**：目标和关键结果是一个目标设定框架，起源于 1970 年代的英特尔，由个人、团队和组织用于定义可衡量的目标并跟踪其成果。

**鸽笼原理**：描述存在固定数量的结果和更大数量的试验的情况。如果你掷硬币三次，那么正面或反面中至少有一个必须出现两次。

**产品需求文档（PRD）**：PRD 是一个文档，将产品的背景、参考、理由和需求表述汇集到一个地方。

**可重现性**：按需重现给定结果的能力。通常在软件开发中采取用户按下按钮 X 的形式，然后应用程序崩溃。如果按下按钮是导致应用程序崩溃的完整且可靠的描述，那么这是一个具有理解的重现步骤的可重现崩溃。

**征求意见（RFC）**：一个概述想法、哲学、提议或方法论的文档，旨在收集反馈并最终成为长期参考材料。

**根本原因分析（RCA）**：一种方法，通常是一个文档，试图深入挖掘表面，真正理解为什么会发生某个事件。通常用作调查工具，然后作为参考文档，用于软件项目中为什么会发生事件。

**SaaS 管理平台（SMP）**：SMP 提供一个单一位置来审查、管理、优化和管理整个组织中使用的 SaaS 工具。

**面向服务的架构（SOA）**：短语面向服务的架构（SOA）起源于 1990 年代，用于指代一些相当具体的技术选择。如今，该短语用于更广泛地描述一个系统，其中信息通过网络在系统的各个部分之间移动。

**站立会议**：（又名每日站会）作为 scrum/敏捷仪式一部分的定期会议。通常旨在简短，少于 30 分钟，以促进团队内的沟通、更新、冲突解决和决策制定。

**草人模型**：可以用不完整的数据快速组合在一起的初稿提案。通常用作与团队的起点提案，以加速收集反馈和达成解决方案的过程。

**同步/异步工作场所文化**：异步工作场所文化的想法是鼓励通信流异步进行，即不需要通信的双方同时参与。例如，书面文档促进异步通信，作者在读者消费文档时不需要在场。异步文化不强调会议，强调书面或录制的音频/视频文档。


# 关于作者

Zach Goldberg 以优异成绩毕业于宾夕法尼亚大学，获得计算机科学与工程学位。他曾担任六家创业公司的 CTO，包括 WiFast、Sticks and Brains、AutoLotto、Trellis Technologies、GrowFlow（被 Dama Financial 收购，2022 年）和 Towards Equilibrium Inc，以及腾讯的常驻企业家和谷歌的副产品经理。在 Dama 于 2022 年收购 GrowFlow 后，Zach 坐下来将他所有的经验倾注到这本书中。在 zachgoldberg.com 了解更多关于 Zach 的工作。


# 关于出版商

WorldChangers Media 由 Bryna Haynes 于 2021 年创立，是一家精品出版公司，专注于影响力创意。我们知道伟大的书籍会改变生活，推翻过时的范式，并建立运动。我们的承诺是为下一代思想领袖提供卓越品质的变革性非虚构作品。

准备好与我们一起撰写和出版你的思想领导力书籍了吗？在 www.WorldChangers.Media 了解更多信息。
